###########################################
# Base image 
###########################################
FROM ubuntu:{{ ubuntu_distro }} AS base

ENV IGN_DISTRO={{ ign_distro }}

# Avoid warnings by switching to noninteractive
ENV DEBIAN_FRONTEND=noninteractive

RUN apt-get update \
  && apt-get install -y \
  gnupg2 \
  lsb-release \
  sudo \
  wget \
  && rm -rf /var/lib/apt/lists/*

COPY install_base.sh /setup/install_base.sh
RUN ./setup/install_base.sh && rm -rf /var/lib/apt/lists/*


###########################################
# Develop image 
###########################################
FROM base AS dev

ENV GAZEBO_VERSION={{ gazebo_version }}

ENV DEBIAN_FRONTEND=noninteractive
# Install dev tools
COPY install_dev.sh /setup/install_dev.sh
RUN ./setup/install_dev.sh && rm -rf /var/lib/apt/lists/*

{% include 'snippits/ros_user.jinja' %}
ENV DEBIAN_FRONTEND=
